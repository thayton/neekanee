#!/usr/bin/env python

import os
import sys
import time

sys.path.append(os.path.realpath(os.path.join(os.path.dirname(__file__), '../../../')))
sys.path.append(os.path.realpath(os.path.join(os.path.dirname(__file__), '../../')))

os.environ['DJANGO_SETTINGS_MODULE'] = 'settings'

from django.core.exceptions import ObjectDoesNotExist
from neekanee_solr.models import *

"""
Used to import lat,lng coordinates for each of the countries we support
into Location table in database.
"""
from geopy import geocoders

country_name_to_code = {
    'guinea bissau': 'gw',
    'guam': 'gu',
    'guatemala': 'gt',
    'greece': 'gr',
    'equatorial guinea': 'gq',
    'guadeloupe': 'gp',
    'guiana': 'gy',
    'french guiana': 'gf',
    'georgia': 'ge',
    'grenada': 'gd',
    'great britain': 'gb',
    'gabon': 'ga',
    'guinea': 'gn',
    'gambia': 'gm',
    'greenland': 'gl',
    'gibraltar': 'gi',
    'ghana': 'gh',
    'tanzania': 'tz',
    'tuvalu': 'tv',
    'taiwan': 'tw',
    'turkey': 'tr',
    'east timor': 'tp',
    'tunisia': 'tn',
    'tonga': 'to',
    'turkmenistan': 'tm',
    'tadjikistan': 'tj',
    'tokelau': 'tk',
    'thailand': 'th',
    'french southern territories': 'tf',
    'togo': 'tg',
    'chad': 'td',
    'dominican republic': 'do',
    'dominica': 'dm',
    'djibouti': 'dj',
    'denmark': 'dk',
    'germany': 'de',
    'algeria': 'dz',
    'vanuatu': 'vu',
    'qatar': 'qa',
    'zambia': 'zm',
    'south africa': 'za',
    'zimbabwe': 'zw',
    'zaire': 'zr',
    'wallis and futuna islands': 'wf',
    'japan': 'jp',
    'jamaica': 'jm',
    'jordan': 'jo',
    'samoa': 'ws',
    'cook islands': 'ck',
    'ivory coast': 'ci',
    'switzerland': 'ch',
    'colombia': 'co',
    'china': 'cn',
    'cameroon': 'cm',
    'chile': 'cl',
    'cocos islands': 'cc',
    'canada': 'ca',
    'congo': 'cg',
    'central african republic': 'cf',
    'the democratic republic of the congo': 'cd',
    'czech republic': 'cz',
    'cyprus': 'cy',
    'christmas island': 'cx',
    'costa rica': 'cr',
    'cape verde': 'cv',
    'cuba': 'cu',
    'puerto rico': 'pr',
    'palau': 'pw',
    'portugal': 'pt',
    'paraguay': 'py',
    'panama': 'pa',
    'french polynesia': 'pf',
    'papua new guinea': 'pg',
    'peru': 'pe',
    'pakistan': 'pk',
    'philippines': 'ph',
    'pitcairn island': 'pn',
    'poland': 'pl',
    'saint pierre and miquelon': 'pm',
    'moldavia': 'md',
    'madagascar': 'mg',
    'morocco': 'ma',
    'monaco': 'mc',
    'myanmar': 'mm',
    'mali': 'ml',
    'macau': 'mo',
    'mongolia': 'mn',
    'marshall islands': 'mh',
    'macedonia': 'mk',
    'mauritius': 'mu',
    'malta': 'mt',
    'malawi': 'mw',
    'maldives': 'mv',
    'martinique': 'mq',
    'northern mariana islands': 'mp',
    'montserrat': 'ms',
    'mauritania': 'mr',
    'malaysia': 'my',
    'mexico': 'mx',
    'mozambique': 'mz',
    'holy see': 'va',
    'venezuela': 've',
    'british virgin islands': 'vg',
    'iraq': 'iq',
    'us virgin islands': 'vi',
    'iceland': 'is',
    'iran': 'ir',
    'italy': 'it',
    'vietnam': 'vn',
    'israel': 'il',
    'british indian ocean territory': 'io',
    'india': 'in',
    'ireland': 'ie',
    'indonesia': 'id',
    'france': 'fr',
    'finland': 'fi',
    'fiji': 'fj',
    'falkland islands': 'fk',
    'micronesia': 'fm',
    'faroe islands': 'fo',
    'swaziland': 'sz',
    'syria': 'sy',
    'suriname': 'sr',
    'el salvador': 'sv',
    'slovak republic': 'sk',
    'svalbard and jan mayen islands': 'sj',
    'slovenia': 'si',
    'saint helena': 'sh',
    'somalia': 'so',
    'senegal': 'sn',
    'san marino': 'sm',
    'sierra leone': 'sl',
    'seychelles': 'sc',
    'solomon islands': 'sb',
    'saudi arabia': 'sa',
    'singapore': 'sg',
    'sweden': 'se',
    'sudan': 'sd',
    'lebanon': 'lb',
    'saint lucia': 'lc',
    'laos': 'la',
    'sri lanka': 'lk',
    'liechtenstein': 'li',
    'latvia': 'lv',
    'lithuania': 'lt',
    'luxembourg': 'lu',
    'liberia': 'lr',
    'lesotho': 'ls',
    'libya': 'ly',
    'yemen': 'ye',
    'yugoslavia': 'yu',
    'mayotte': 'yt',
    'western sahara': 'eh',
    'estonia': 'ee',
    'egypt': 'eg',
    'ecuador': 'ec',
    'ethiopia': 'et',
    'spain': 'es',
    'eritrea': 'er',
    'russian federation': 'ru',
    'rwanda': 'rw',
    'reunion': 're',
    'romania': 'ro',
    'bangladesh': 'bd',
    'belgium': 'be',
    'burkina faso': 'bf',
    'bulgaria': 'bg',
    'bosnia-herzegovina': 'ba',
    'barbados': 'bb',
    'bermuda': 'bm',
    'brunei darussalam': 'bn',
    'bolivia': 'bo',
    'bahrain': 'bh',
    'burundi': 'bi',
    'benin': 'bj',
    'bhutan': 'bt',
    'bouvet island': 'bv',
    'botswana': 'bw',
    'brazil': 'br',
    'bahamas': 'bs',
    'belarus': 'by',
    'belize': 'bz',
    'oman': 'om',
    'croatia': 'hr',
    'haiti': 'ht',
    'hungary': 'hu',
    'hong kong': 'hk',
    'honduras': 'hn',
    'heard and mcdonald islands': 'hm',
    'uruguay': 'uy',
    'uzbekistan': 'uz',
    'united states': 'us',
    'usa': 'us',
    'united kingdom': 'uk',
    'uganda': 'ug',
    'ukraine': 'ua',
    'united arab emirates': 'ae',
    'principality of andorra': 'ad',
    'antigua': 'ag',
    'afghanistan': 'af',
    'anguilla': 'ai',
    'armenia': 'am',
    'albania': 'al',
    'angola': 'ao',
    'netherlands antilles': 'an',
    'antarctica': 'aq',
    'american samoa': 'as',
    'argentina': 'ar',
    'australia': 'au',
    'austria': 'at',
    'aruba': 'aw',
    'azerbaidjan': 'az',
    'nicaragua': 'ni',
    'netherlands': 'nl',
    'the netherlands': 'nl',
    'norway': 'no',
    'namibia': 'na',
    'new caledonia': 'nc',
    'niger': 'ne',
    'norfolk island': 'nf',
    'nigeria': 'ng',
    'new zealand': 'nz',
    'nepal': 'np',
    'nauru': 'nr',
    'neutral zone': 'nt',
    'niue': 'nu',
    'kyrgyzstan': 'kg',
    'kenya': 'ke',
    'kiribati': 'ki',
    'cambodia': 'kh',
    'comoros': 'km',
    'south korea': 'kr',
    'north korea': 'kp',
    'kuwait': 'kw',
    'kazakhstan': 'kz',
    'cayman islands': 'ky'
}

country_code_coords = {
    'gw': (11.803749, -15.180413),
    'gu': (36.901940000000003, -89.823610000000002),
    'gt': (15.783471, -90.230759000000006),
    'gr': (39.074207999999999, 21.824311999999999),
    'gq': (1.650801, 10.267894999999999),
    'gp': (16.265000000000001, -61.551000000000002),
    'gy': (4.8604159999999998, -58.93018),
    'gf': (3.9338890000000002, -53.125782000000001),
    'ge': (32.157435100000001, -82.907122999999999),
    'gd': (12.262776000000001, -61.604171000000001),
    'gb': (55.378050999999999, -3.4359730000000002),
    'ga': (-0.80368899999999999, 11.609444),
    'gn': (9.9455869999999997, -9.6966450000000002),
    'gm': (13.443182, -15.310138999999999),
    'gl': (71.706935999999999, -42.604303000000002),
    'gi': (36.137740999999998, -5.3453739999999996),
    'gh': (7.9465269999999997, -1.0231939999999999),
    'tz': (-6.3690280000000001, 34.888821999999998),
    'tv': (-7.1095350000000002, 177.64932999999999),
    'tw': (23.69781, 120.960515),
    'tr': (38.963745000000003, 35.243321999999999),
    'tp': (-8.8742169999999998, 125.72753899999999),
    'tn': (33.886916999999997, 9.5374990000000004),
    'to': (-21.178985999999998, -175.19824199999999),
    'tm': (38.969718999999998, 59.556277999999999),
    'tj': (38.861033999999997, 71.276093000000003),
    'tk': (-8.9673630000000006, -171.85588100000001),
    'th': (15.870032, 100.992541),
    'tf': (-49.280366000000001, 69.348557),
    'tg': (8.6195430000000002, 0.82478200000000002),
    'td': (15.454166000000001, 18.732206999999999),
    'do': (18.735693000000001, -70.162650999999997),
    'dm': (15.414999, -61.370975999999999),
    'dj': (11.825138000000001, 42.590274999999998),
    'dk': (56.263919999999999, 9.5017849999999999),
    'de': (51.165691000000002, 10.451525999999999),
    'dz': (28.033885999999999, 1.659626),
    'qa': (25.354825999999999, 51.183883999999999),
    'zm': (-13.133896999999999, 27.849332),
    'za': (-30.559481999999999, 22.937505999999999),
    'zw': (-19.015438, 29.154857),
    'zr': (-4.0383329999999997, 21.758664),
    'wf': (-14.2903576, -178.1193763),
    'jp': (36.204824000000002, 138.25292400000001),
    'jm': (18.109580999999999, -77.297507999999993),
    'jo': (30.585163999999999, 36.238413999999999),
    'ws': (-13.759029, -172.10462899999999),
    'ck': (-21.236736000000001, -159.777671),
    'ci': (7.5399890000000003, -5.5470800000000002),
    'ch': (46.818187999999999, 8.2275120000000008),
    'co': (4.5708679999999999, -74.297332999999995),
    'cn': (35.861660000000001, 104.195397),
    'cm': (7.3697220000000003, 12.354722000000001),
    'cl': (-35.675147000000003, -71.542968999999999),
    'cc': (-12.164165000000001, 96.870956000000007),
    'ca': (56.130366000000002, -106.346771),
    'cg': (-0.228021, 15.827659000000001),
    'cf': (6.6111110000000002, 20.939444000000002),
    'cd': (-4.0383329999999997, 21.758664),
    'cz': (49.817492000000001, 15.472962000000001),
    'cy': (35.126412999999999, 33.429859),
    'cx': (-10.447525000000001, 105.690449),
    'cr': (9.7489170000000005, -83.753428),
    'cv': (16.002082000000001, -24.013197000000002),
    'cu': (21.521757000000001, -77.781166999999996),
    'pr': (18.220832999999999, -66.590148999999997),
    'pw': (7.5149800000000004, 134.58251999999999),
    'pt': (39.399872000000002, -8.2244539999999997),
    'py': (-23.442502999999999, -58.443832),
    'pa': (8.5379810000000003, -80.782127000000003),
    'pf': (-17.679742000000001, -149.40684300000001),
    'pg': (-6.3149930000000003, 143.95554999999999),
    'pe': (-9.1899669999999993, -75.015152),
    'pk': (30.375321, 69.345116000000004),
    'ph': (12.879721, 121.774017),
    'pn': (-24.703614999999999, -127.439308),
    'pl': (51.919438, 19.145136000000001),
    'pm': (46.941935999999998, -56.27111),
    'md': (47.411631, 28.369885),
    'mg': (-18.766946999999998, 46.869107),
    'ma': (31.791702000000001, -7.0926200000000001),
    'mc': (43.738417599999998, 7.4246157999999998),
    'mm': (21.913965000000001, 95.956222999999994),
    'ml': (17.570692000000001, -3.9961660000000001),
    'mo': (22.198744999999999, 113.543873),
    'mn': (46.862496, 103.846656),
    'mh': (7.1314739999999999, 171.18447800000001),
    'mk': (41.608635, 21.745274999999999),
    'mu': (-20.348403999999999, 57.552152),
    'mt': (35.937496000000003, 14.375416),
    'mw': (-13.254308, 34.301524999999998),
    'mv': (3.2027779999999999, 73.220680000000002),
    'mq': (14.641527999999999, -61.024174000000002),
    'mp': (17.330829999999999, 145.38469000000001),
    'ms': (16.742498000000001, -62.187365999999997),
    'mr': (21.00789, -10.940835),
    'my': (4.2104840000000001, 101.97576599999999),
    'mx': (23.634501, -102.552784),
    'mz': (-18.665694999999999, 35.529561999999999),
    'va': (41.902915999999998, 12.453389),
    've': (6.4237500000000001, -66.589730000000003),
    'vg': (18.420694999999998, -64.639967999999996),
    'iq': (33.223191, 43.679290999999999),
    'vi': (18.335764999999999, -64.896334999999993),
    'is': (64.963050999999993, -19.020835000000002),
    'ir': (32.427908000000002, 53.688046),
    'it': (41.871940000000002, 12.56738),
    'vn': (14.058324000000001, 108.277199),
    'vu': (-15.376706, 166.959158),
    'io': (-6.3431940000000004, 71.876519000000002),
    'in': (20.593684, 78.962879999999998),
    'ie': (53.412909999999997, -8.2438900000000004),
    'id': (-0.78927499999999995, 113.92132700000001),
    'il': (31.046050999999999, 34.851612000000003),
    'fr': (46.227637999999999, 2.213749),
    'fx': (47.594657300000001, 6.9207716000000001),
    'fi': (61.924109999999999, 25.748151),
    'fj': (-17.713370999999999, 178.065032),
    'fk': (-51.796253, -59.523612999999997),
    'fm': (7.425554, 150.55081200000001),
    'fo': (61.892634999999999, -6.9118060000000003),
    'sz': (-26.522503, 31.465865999999998),
    'sy': (34.802075000000002, 38.996814999999998),
    'sr': (3.919305, -56.027782999999999),
    'sv': (13.794185000000001, -88.896529999999998),
    'st': (0.26025680000000001, 6.6210611000000004),
    'sk': (48.669026000000002, 19.699024000000001),
    'sj': (71.021353700000006, -8.5223128999999993),
    'si': (46.151240999999999, 14.995463000000001),
    'sh': (38.502777799999997, -122.46972220000001),
    'so': (5.1521489999999996, 46.199615999999999),
    'sn': (14.497401, -14.452362000000001),
    'sm': (43.942360000000001, 12.457777),
    'sl': (8.4605549999999994, -11.779889000000001),
    'sc': (-4.6795739999999997, 55.491976999999999),
    'sb': (-9.6457099999999993, 160.156194),
    'sa': (23.885942, 45.079161999999997),
    'sg': (1.3520829999999999, 103.819836),
    'se': (60.128160999999999, 18.643501000000001),
    'sd': (12.862807, 30.217635999999999),
    'lb': (33.854720999999998, 35.862285),
    'lc': (13.909444000000001, -60.978892999999999),
    'la': (19.856269999999999, 102.495496),
    'lk': (7.8730539999999998, 80.771797000000007),
    'li': (47.165999999999997, 9.5553729999999995),
    'lv': (56.879635, 24.603189),
    'lt': (55.169438, 23.881274999999999),
    'lu': (49.815272999999998, 6.1295830000000002),
    'lr': (6.4280549999999996, -9.4294989999999999),
    'ls': (-29.609988000000001, 28.233608),
    'ly': (26.335100000000001, 17.228331000000001),
    'ye': (15.552727000000001, 48.516387999999999),
    'yu': (25.784771299999999, -100.2478521),
    'yt': (-12.827500000000001, 45.166243999999999),
    'eh': (24.215527000000002, -12.885833999999999),
    'ee': (58.595272000000001, 25.013607),
    'eg': (26.820553, 30.802498),
    'ec': (-1.8312390000000001, -78.183406000000005),
    'et': (9.1449999999999996, 40.489673000000003),
    'es': (40.463667000000001, -3.7492200000000002),
    'er': (15.179384000000001, 39.782333999999999),
    'ru': (61.524009999999997, 105.31875599999999),
    'rw': (-1.9402779999999999, 29.873888000000001),
    're': (-21.115141000000001, 55.536383999999998),
    'ro': (45.943161000000003, 24.966760000000001),
    'bd': (23.684994, 90.356330999999997),
    'be': (50.503886999999999, 4.4699359999999997),
    'bf': (12.238333000000001, -1.561593),
    'bg': (42.733882999999999, 25.48583),
    'ba': (43.915886, 17.679075999999998),
    'bb': (13.193887, -59.543197999999997),
    'bm': (32.321384000000002, -64.757369999999995),
    'bn': (4.5352769999999998, 114.72766900000001),
    'bo': (-16.290154000000001, -63.588653000000001),
    'bh': (25.930413999999999, 50.637771999999998),
    'bi': (-3.3730560000000001, 29.918886000000001),
    'bj': (9.3076899999999991, 2.3158340000000002),
    'bt': (27.514161999999999, 90.433600999999996),
    'bv': (-54.423198999999997, 3.4131939999999998),
    'bw': (-22.328474, 24.684866),
    'br': (-14.235004, -51.925280000000001),
    'bs': (25.034279999999999, -77.396280000000004),
    'by': (53.709806999999998, 27.953389000000001),
    'bz': (17.189876999999999, -88.497649999999993),
    'om': (21.512582999999999, 55.923254999999997),
    'hr': (45.100000000000001, 15.199999999999999),
    'ht': (18.971187, -72.285214999999994),
    'hu': (47.162494000000002, 19.503304),
    'hk': (22.396428, 114.109497),
    'hn': (15.199999, -86.241905000000003),
    'hm': (-53.106000000000002, 73.513000000000005),
    'uy': (-32.522779, -55.765835000000003),
    'uz': (41.377490999999999, 64.585262),
    'us': (37.090240000000001, -95.712890999999999),
    'uk': (55.378050999999999, -3.4359730000000002),
    'ug': (1.3733329999999999, 32.290275000000001),
    'ua': (48.379432999999999, 31.165579999999999),
    'ae': (23.424075999999999, 53.847817999999997),
    'ad': (42.546244999999999, 1.6015539999999999),
    'ag': (17.074655700000001, -61.817520700000003),
    'af': (33.939109999999999, 67.709952999999999),
    'ai': (18.220554, -63.068615000000001),
    'am': (40.069099000000001, 45.038189000000003),
    'al': (41.153331999999999, 20.168330999999998),
    'ao': (-11.202692000000001, 17.873887),
    'an': (12.226079, -69.060086999999996),
    'aq': (-82.862751900000006, -135.0),
    'as': (-14.270972, -170.132217),
    'ar': (-38.416097000000001, -63.616672000000001),
    'au': (-25.274398000000001, 133.775136),
    'at': (47.516230999999998, 14.550072),
    'aw': (12.52111, -69.968338000000003),
    'az': (40.143104999999998, 47.576926999999998),
    'ni': (12.865416, -85.207228999999998),
    'nl': (52.132632999999998, 5.2912660000000002),
    'no': (60.472023999999998, 8.4689460000000008),
    'na': (-22.957640000000001, 18.490410000000001),
    'nc': (-20.904305000000001, 165.618042),
    'ne': (17.607789, 8.0816660000000002),
    'nf': (-29.040835000000001, 167.954712),
    'ng': (9.0819989999999997, 8.6752769999999995),
    'nz': (-40.900556999999999, 174.88597100000001),
    'np': (28.394856999999998, 84.124008000000003),
    'nr': (-0.52277799999999996, 166.93150299999999),
    'nt': (42.280315199999997, -83.745584600000001),
    'nu': (-19.054445000000001, -169.867233),
    'kg': (41.20438, 74.766098),
    'ke': (-0.023559, 37.906193000000002),
    'ki': (-3.3704170000000002, -168.734039),
    'kh': (11.581486399999999, 104.9174405),
    'km': (-11.875000999999999, 43.872219000000001),
    'kr': (35.907756999999997, 127.76692199999999),
    'kp': (40.339852, 127.510093),
    'kw': (29.31166, 47.481766),
    'kz': (48.019573000000001, 66.923683999999994),
    'ky': (19.513469000000001, -80.566956000000005)
}

def set_country_code_coords():
    g = geocoders.Google()

    for country,code in country_name_to_code.items():
        if country_code_coords[code] is None:
            results = g.geocode(country, exactly_one=False)
            place, (lat,lng) = results[0]
            country_code_coords[code] = (lat,lng)
            time.sleep(1)

    x = open('out.txt', 'w')
    x.write('%s' % country_code_coords)
    x.close()

def load_country_code_coords():
    for code,(lat,lng) in country_code_coords.items():
        try:
            l = Location.objects.get(city='', state='', country=code)
        except ObjectDoesNotExist:
            l = Location(city='', state='', country=code, lat=lat, lng=lng)
            l.save()
        else:
            print 'Warning - location already exists: %s' % l

if __name__ == '__main__':
    set_country_code_coords()
    load_country_code_coords()
